<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Checkout</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 24px; }
      table { border-collapse: collapse; width: 100%; max-width: 800px; }
      th, td { padding: 8px 12px; border: 1px solid #ddd; }
      th { background: #f7f7f7; text-align: left; }
      .totals { margin-top: 16px; max-width: 800px; }
      .right { text-align: right; }
      .btn { display: inline-block; padding: 10px 16px; background: #28a745; color: white; text-decoration: none; border-radius: 4px; }
      .btn:disabled { background: #aaa; }
    </style>
  </head>
  <body>
    <h1>Checkout</h1>

    {% if cart_items and cart_items|length > 0 %}
      <table>
        <thead>
          <tr>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart_items %}
            <tr>
              <td>{{ item.product_name if item.product_name is defined else (item.get('product_name') or 'Product') }}</td>
              <td>₹{{ '%.2f' % item.price }}</td>
              <td>{{ item.quantity }}</td>
              <td>₹{{ '%.2f' % (item.price * item.quantity) }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="totals">
        <p class="right">Subtotal: <strong>₹{{ '%.2f' % total }}</strong></p>
        <p class="right">Delivery fee (10%): <strong>₹{{ '%.2f' % delivery_fee }}</strong></p>
        <p class="right">Grand total: <strong>₹{{ '%.2f' % grand_total }}</strong></p>
      </div>

      <form method="post" action="{{ url_for('checkout') }}">
        <button type="submit" class="btn">Proceed to Payment</button>
      </form>

    {% else %}
      <p>Your cart is empty.</p>
      <a href="{{ url_for('buyer_dashboard') }}">Continue shopping</a>
    {% endif %}

  </body>
</html>
